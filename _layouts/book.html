---
layout: default
---

<article class="page">
  <h1 class="page-title"><cite class="book-title">{{ page.title }}</cite></h1>

  {% assign image = page | optional: 'image' %}
  {% if image %}
  <div class="book-cover-float-container">
    <img class="book-cover-lead"
      src="{{ image }}"
      alt="Book cover of {{ page.title }}."
    >
  </div>
  {% endif %}

  <!-- Book Metadata -->

  {% comment %} Authors {% endcomment %}
  {% assign authors_html_output = "" %}
  {% capture captured_authors_html %}
    {% assign book_authors = page | optional: 'book_authors' %}
    {% display_authors book_authors %}
  {% endcapture %}
  {% assign authors_html_output = captured_authors_html | strip %}

  {% if authors_html_output != "" %}
    <div class="written-by">by {{ authors_html_output }}</div>
  {% endif %}

  {% comment %} Series {% endcomment %}
  {% assign series = page | optional: 'series' %}
  {% assign book_number = page | optional: 'book_number' %}

  {% if series and book_number %}
    <div class="book-series-line">
      Book {{book_number}} of {% series_text series %}
    </div>
  {% endif %}

  {% comment %} Awards and Favorites {% endcomment %}
  {%- assign data = site | optional: 'data' -%}
  {%- assign link_cache = data | optional: 'link_cache' -%}
  {%- assign favorites_cache = link_cache | optional: 'favorites_mentions' -%}
  {%- assign mentioning_posts = favorites_cache | optional: page.url | default: nil -%}

  {% assign awards = page | optional: 'awards' %}

  {% if awards or mentioning_posts %}
    <div class="book-awards">Awards:
    {% if awards %}
        {% assign sorted_awards = awards | sort %}
        {% for award in sorted_awards %}
          <a class="book-award" href="/books/by-award/#{{ award | slugify }}-award">
            {%- assign words = award | split: ' ' -%}
            {%- for word in words %}
              {{ word | capitalize }}{%- unless forloop.last %} {% endunless -%}
            {% endfor -%}
          </a>{%- unless forloop.last -%}, {%- endunless -%}
        {% endfor %}
      {%- endif -%}

      {%- if awards and mentioning_posts -%}, {% endif -%}

      {%- if mentioning_posts -%}
        {%- assign sorted_posts = mentioning_posts | sort: "is_favorites_list" | reverse -%}
        {%- for post in sorted_posts -%}
          <a class="book-favorite-link" href="{{ post.url | relative_url }}">{{ post.is_favorites_list }} Favorites</a>{%- unless forloop.last -%}, {% endunless -%}
        {%- endfor -%}
      {%- endif -%}

    </div>
  {% endif %}

  {%- comment -%} On an ARCHIVED page, link back to its canonical version {%- endcomment -%}
  {% assign canonical_url = page | optional: 'canonical_url' %}
  {%- if canonical_url and canonical_url != "" -%}
    <div class="archived-notice">
      This is an archived review from {{ page.date | date: '%B %d, %Y' }}.
      Read the <a href="{{ canonical_url | relative_url
      }}"><strong>current review</strong></a>.
    </div>
  {%- endif -%}

  <h2 class="book-review-headline">Review</h2>
  {% comment %}Add star rating, if one exists in the metadata{% endcomment %}
  {% assign rating = page | optional: 'rating' %}
  {% if rating %}
    {% rating_stars rating %}
  {% endif %}

  {{ content }}

</article>

<hr>

<!-- Backlinks -->
{% book_backlinks %}

<!-- Previous Reviews (if any) -->
{% display_previous_reviews %}

<!-- Related and Recent Books -->
{% related_books %}
