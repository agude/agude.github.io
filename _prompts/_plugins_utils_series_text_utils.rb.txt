I need you to refactor the following Ruby file to fix RuboCop static analysis errors.

FILE: _plugins/utils/series_text_utils.rb

THE ERRORS TO FIX:
- Line 44: [Metrics/AbcSize] Assignment Branch Condition size for `analyze_series_name` is too high. [<9, 13, 10> 18.71/17]
- Line 44: [Metrics/CyclomaticComplexity] Cyclomatic complexity for `analyze_series_name` is too high. [9/7]
- Line 44: [Metrics/MethodLength] Method has too many lines. [23/10]
- Line 44: [Metrics/PerceivedComplexity] Perceived complexity for `analyze_series_name` is too high. [10/8]


INSTRUCTIONS:
1. Fix the specific errors listed above.
2. If the error is "Metrics/MethodLength" or "Metrics/AbcSize", please extract logic into private helper methods.
3. If the error is "Style/FrozenStringLiteralComment", add the comment to the top of the file.
4. DO NOT change the external behavior of the code.
5. DO NOT remove comments unless they are the specific "rubocop:disable" comments causing issues.
6. Return the FULL content of the fixed file.

SOURCE CODE:
```ruby
# frozen_string_literal: true

# _plugins/utils/series_text_utils.rb

module SeriesTextUtils
  # Define common words that imply a series type.
  # These are checked as whole words against the normalized series name.
  SERIES_TYPE_WORDS = %w[
    adventures
    anthologies
    anthology
    arc
    book
    books
    cantos
    chronicle
    chronicles
    collection
    collections
    cycle
    cycles
    diaries
    mythos
    saga
    sagas
    sequence
    sequences
    series
    song
    songs
    trilogies
    trilogy
    universe
    universes
  ].freeze

  # Analyzes a series name to determine grammatical prefix and suffix.
  #
  # @param raw_series_name [String, nil] The raw series name.
  # @return [Hash, nil] A hash with :prefix, :name, :suffix, or nil if input is invalid.
  #   Example: { prefix: "the ", name: "Foundation", suffix: " series" }
  #            { prefix: "", name: "The Expanse", suffix: " series" }
  #            { prefix: "the ", name: "Dune Saga", suffix: "" }
  def self.analyze_series_name(raw_series_name)
    return nil if raw_series_name.nil? || raw_series_name.to_s.strip.empty?

    stripped_name = raw_series_name.to_s.strip
    return nil if stripped_name.empty? # Double check after stripping

    normalized_name_for_logic = stripped_name.downcase

    # Determine Prefix
    prefix = if normalized_name_for_logic.start_with?('the ', 'a ', 'an ')
               ''
             else
               'the '
             end

    # Determine Suffix
    contains_series_type_word = false
    series_title_words = normalized_name_for_logic.split(/\s+/)
    SERIES_TYPE_WORDS.each do |type_word|
      if series_title_words.any? { |title_word| title_word.gsub(/[[:punct:]]$/, '') == type_word }
        contains_series_type_word = true
        break
      end
    end
    suffix = contains_series_type_word ? '' : ' series'

    {
      prefix: prefix,
      name: stripped_name, # Return the original stripped name for linking
      suffix: suffix
    }
  end
end
```
