I need you to refactor the following Ruby file to fix RuboCop static analysis errors and improve general code quality.

FILE: _plugins/series_text_tag.rb

THE ERRORS TO FIX:
- Line 19: [Metrics/MethodLength] Method has too many lines. [19/10]
- Line 27: [Lint/DuplicateBranch] Duplicate branch body detected.


STYLE GUIDE & REFACTORING PATTERNS:
1. **Complex Logic Extraction (Tags/Classes):**
   - If a method (like `render`) is too complex, extract the logic into a private helper class defined within the same module/class.
   - **Pattern:**
     ```ruby
     def render(context)
       MyTagRenderer.new(context).render
     end

     # Helper class to handle rendering logic
     class MyTagRenderer
       def initialize(context)
         @context = context
         @site = context.registers[:site]
       end

       def render
         # logic here
       end
     end
     ```

2. **Stateless Utilities (Modules):**
   - For utility modules, keep methods static (`def self.method`).
   - Break complex logic into private class methods named with a leading underscore.
   - **Pattern:**
     ```ruby
     def self.public_method(arg)
       _private_helper(arg)
     end

     def self._private_helper(arg)
       # logic
     end
     ```

3. **General Quality:**
   - Fix "bad code" or poor style even if RuboCop misses it (e.g., redundant logic, unclear variable names, deeply nested conditionals).
   - Ensure `# frozen_string_literal: true` is at the top.

INSTRUCTIONS:
1. Fix the specific RuboCop errors listed above.
2. Apply the Refactoring Patterns defined in the Style Guide.
3. Improve readability and maintainability generally.
4. **CRITICAL:** DO NOT change the external behavior or API of the code.
5. DO NOT remove comments unless they are the specific "rubocop:disable" comments causing issues.
6. Return the FULL content of the fixed file.

SOURCE CODE:
```ruby
# frozen_string_literal: true

# _plugins/series_text_tag.rb
require 'jekyll'
require 'liquid'
# CGI and strscan are still used by the tag's initialize
require 'cgi'
require 'strscan'
require_relative 'utils/series_link_util'
require_relative 'utils/tag_argument_utils'
require_relative 'utils/series_text_utils' # Require the new utility

module Jekyll
  class SeriesTextTag < Liquid::Tag
    QuotedFragment = Liquid::QuotedFragment

    # SERIES_TYPE_WORDS is now in SeriesTextUtils

    def initialize(tag_name, markup, tokens)
      super
      @raw_markup = markup
      @series_name_markup = nil
      scanner = StringScanner.new(markup.strip)

      if scanner.scan(QuotedFragment)
        @series_name_markup = scanner.matched
      elsif scanner.scan(/\S+/)
        @series_name_markup = scanner.matched
      else
        raise Liquid::SyntaxError, "Syntax Error in 'series_text': Could not find series name in '#{@raw_markup}'"
      end

      scanner.skip(/\s+/)
      unless scanner.eos?
        raise Liquid::SyntaxError,
              "Syntax Error in 'series_text': Unexpected arguments '#{scanner.rest}' in '#{@raw_markup}'"
      end
      return if @series_name_markup && !@series_name_markup.strip.empty?

      raise Liquid::SyntaxError,
            "Syntax Error in 'series_text': Series name value is missing or empty in '#{@raw_markup}'"
    end

    def render(context)
      raw_series_name_input = TagArgumentUtils.resolve_value(@series_name_markup, context)

      analysis = SeriesTextUtils.analyze_series_name(raw_series_name_input)
      return '' if analysis.nil? # Handles nil/empty input via the utility

      # Generate Linked Series Name using the original stripped name from analysis
      linked_series_html = SeriesLinkUtils.render_series_link(analysis[:name], context)
      return '' if linked_series_html.strip.empty? && analysis[:prefix].empty? && analysis[:suffix].empty?

      # Combine and Output
      output = "#{analysis[:prefix]}#{linked_series_html}#{analysis[:suffix]}"
      output.strip
    end
  end
end

Liquid::Template.register_tag('series_text', Jekyll::SeriesTextTag)
```
